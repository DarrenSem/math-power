{"version":3,"sources":["./dist/calc.js","./dist/browser.js"],"sourcesContent":["// calc.ts: loaded after defer-loaded \"calc.ts\"\n(function (root, factory) {\n    typeof define === \"function\" && define.amd\n        ? define([], factory)\n        : typeof module === \"object\" && module.exports\n            ? module.exports = factory()\n            : (root.calculate = factory());\n})(typeof self !== \"undefined\" ? self : globalThis, function () {\n    var calculate = function (data) {\n        var nodeArgsMock;\n        if (typeof data === \"string\" || Array.isArray(data)) {\n            nodeArgsMock = data;\n            data = null;\n        }\n        ;\n        if (data === null) {\n            data = getArgsData(calculate.href, nodeArgsMock);\n            if (data === null) {\n                return;\n            }\n            ;\n        }\n        ;\n        if (data == null) {\n            // default logic if undefined (getArgsData had args to parse, or button was clicked)\n            data = calculate.getFieldsData();\n        }\n        ;\n        var _a = data, num1 = _a.num1, operator = _a.operator, num2 = _a.num2;\n        calculate.setFieldsData(num1, operator, num2); // for visual consistency if calculate({key:value})\n        num1 = parseFloat(String(num1));\n        num2 = parseFloat(String(num2));\n        var operations = {\n            \"to the power of\": function (num1, num2) { return Math.pow(num1, num2); },\n            \"plus\": function (num1, num2) { return num1 + num2; },\n            \"minus\": function (num1, num2) { return num1 - num2; },\n            \"times\": function (num1, num2) { return num1 * num2; },\n            \"divided by\": function (num1, num2) { return num1 / num2; },\n        };\n        var fn = operations[operator];\n        if (!fn) {\n            return calculate.warnAfterFocus(\"Please select an operator\");\n        }\n        ;\n        var result = fn(num1, num2);\n        calculate.output(result);\n        return result;\n    };\n    var fieldsMock = {};\n    var getFieldsData = function () {\n        return fieldsMock;\n    };\n    var setFieldsData = function (num1, operator, num2) {\n        fieldsMock.num1 = num1;\n        fieldsMock.operator = operator;\n        fieldsMock.num2 = num2;\n        // delete fieldsMock.result;\n        fieldsMock.result = null;\n        console.warn(fieldsMock);\n    };\n    var warnAfterFocus = function (message) {\n        console.error(message);\n    };\n    var output = function (result) {\n        fieldsMock.result = result;\n        console.log(fieldsMock);\n    };\n    var getArgsData = function (href, nodeArgsMock) {\n        var _a, _b, _c, _d;\n        href = (_a = getNodeArgsData(nodeArgsMock)) !== null && _a !== void 0 ? _a : href;\n        if (!/\\?/.test(href))\n            return null;\n        // new URL(href), because new URLSearchParams(href) seems to skip the 1st param immediately after \"?\"\n        var p = new URL(href).searchParams;\n        calculate.setFieldsData((_b = p.get(\"num1\")) !== null && _b !== void 0 ? _b : \"\", // briefer than p.has(\"num1\") ? p.get(\"num1\") : \"\"\n        (_c = p.get(\"operator\")) !== null && _c !== void 0 ? _c : \"\", (_d = p.get(\"num2\")) !== null && _d !== void 0 ? _d : \"\");\n        // return undefined, to ensure getFieldsData parses the values we just moved into the fields\n        return;\n    };\n    var getNodeArgsData = function (nodeArgsMock) {\n        var _a, _b, _c;\n        var argv = (nodeArgsMock\n            ? [nodeArgsMock].flat()\n            : typeof process !== \"undefined\"\n                ? process.argv.slice(2)\n                : []);\n        var args = argv.length\n            ? argv.join(\" \").replace(/[^a-z\\d.+%-]/gi, \" \").trim()\n            : \"\";\n        var hasNamedArgs = /\\??\\b(num[12]|operator)\\s*[:= ]\\s*[a-z\\d.+%-]/i.test(args);\n        var orderedList = args.split(/\\s+/);\n        var num1, operator, num2;\n        if (hasNamedArgs) {\n            num1 = (_a = args.match(/\\bnum1\\s*[:= ]\\s*([a-z\\d.+%-]*)/i)) === null || _a === void 0 ? void 0 : _a[1];\n            operator = (_b = args.match(/\\boperator\\s*[:= ]\\s*([a-z\\d.+%-]*)/i)) === null || _b === void 0 ? void 0 : _b[1];\n            num2 = (_c = args.match(/\\bnum2\\s*[:= ]\\s*([a-z\\d.+%-]*)/i)) === null || _c === void 0 ? void 0 : _c[1];\n        }\n        else {\n            num1 = orderedList.shift();\n            operator = orderedList.shift();\n            num2 = orderedList.shift();\n        }\n        ;\n        return (args.trim().length\n            ? \"X:?num1=\".concat(num1, \"&operator=\").concat(operator, \"&num2=\").concat(num2)\n            : null);\n    };\n    calculate.getFieldsData = getFieldsData;\n    calculate.setFieldsData = setFieldsData;\n    calculate.warnAfterFocus = warnAfterFocus;\n    calculate.output = output;\n    calculate.href = \"\";\n    // calculate.href = \"https://example.com/api#?num1=3.x&num2=4&operator=times\"; // no automatic .replace(location.hash, \"\");\n    // calculate.href = \"https://example.com/api?num1=3.x&num2=4&operator=times\";\n    // calculate.calculate = calculate;  // useless, it seems: calculate.default = calculate;\n    return calculate;\n});\n// console.log(module.exports);\n// [Function: calculate] {\n//   getFieldsData: [Function: getFieldsData],\n//   setFieldsData: [Function: setFieldsData],\n//   warnAfterFocus: [Function: warnAfterFocus],\n//   output: [Function: output],\n//   href: ''\n// }\n// const calco = globalThis.calculate || module.exports;\n// (null) = try Node CLI args, if that fails then will attempt querystring\n// console.log( calco(null) );\n//# sourceMappingURL=calc.js.map","// browser.ts: defer-loaded after \"calc.ts\"\nvar calculate;\nvar qi = function (id) { return document.getElementById(id); };\nvar num1El = qi(\"num1\");\nvar operatorEl = qi(\"operator\");\nvar num2El = qi(\"num2\");\nvar resultEl = qi(\"result\");\nvar calcEl = qi(\"calc-button\");\ncalculate.getFieldsData = function () {\n    var num1 = num1El.value;\n    var operator = operatorEl.value;\n    var num2 = num2El.value;\n    return { num1: num1, operator: operator, num2: num2 };\n};\ncalculate.setFieldsData = function (num1, operator, num2) {\n    num1El.value = num1;\n    operatorEl.value = operator;\n    num2El.value = num2;\n};\ncalculate.warnAfterFocus = function (message) {\n    operatorEl.focus();\n    alert(message);\n};\ncalculate.output = function (result) {\n    resultEl.value = result;\n    resultEl.focus();\n    resultEl.select();\n};\ncalculate.href = location.href.replace(location.hash, \"\");\nvar main = function (window, setTimeout, delay) {\n    calcEl.onclick = function () { return calculate(); };\n    // auto-calculate based on getArgsData only (silently skipped if no args passed)\n    window.onload = setTimeout(function () {\n        calculate(null);\n    }, delay);\n};\nmain(window, setTimeout, 100); // ensure time enough that HTML fields are visible\n//# sourceMappingURL=browser.js.map"],"names":["root","factory","define","amd","module","exports","calculate","self","globalThis","data","num2","result","Array","isArray","nodeArgsMock","href","_a","_b","_c","_d","getNodeArgsData","test","p","URL","searchParams","setFieldsData","get","num1","getFieldsData","operator","parseFloat","String","fn","to the power of","Math","pow","plus","minus","times","divided by","output","warnAfterFocus","fieldsMock","argv","flat","process","slice","args","length","join","replace","trim","hasNamedArgs","orderedList","split","match","shift","concat","console","warn","message","error","log","qi","id","document","getElementById","num1El","operatorEl","num2El","resultEl","calcEl","main","value","focus","alert","select","location","hash","window","setTimeout","delay","onclick","onload"],"mappings":"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"}